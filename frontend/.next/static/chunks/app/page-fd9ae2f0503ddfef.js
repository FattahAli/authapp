(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6382:function(t,e,a){Promise.resolve().then(a.bind(a,6117))},9376:function(t,e,a){"use strict";var s=a(5475);a.o(s,"useParams")&&a.d(e,{useParams:function(){return s.useParams}}),a.o(s,"useRouter")&&a.d(e,{useRouter:function(){return s.useRouter}})},6117:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return i}});var s=a(7437),o=a(2265),r=a(9376),n=a(6602);function i(){let t=(0,r.useRouter)(),{isAuthenticated:e,getMe:a,isLoading:i,initialize:u}=(0,n.t)(),[l,c]=(0,o.useState)(!1);return((0,o.useEffect)(()=>{u(),c(!0)},[u]),(0,o.useEffect)(()=>{!l||i||e||(async()=>{try{await a()}catch(t){console.error("Auth check failed:",t)}})()},[l,i,a,e]),(0,o.useEffect)(()=>{l&&!i&&(e?t.push("/users"):t.push("/login"))},[e,i,l,t]),i||!l)?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-slate-900",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-white text-lg",children:"Loading..."})]})}):null}},1837:function(t,e,a){"use strict";a.d(e,{g8:function(){return r},iJ:function(){return o}});let s=a(3464).Z.create({baseURL:"http://localhost:5000/api",withCredentials:!0,headers:{"Content-Type":"application/json"}});s.interceptors.request.use(t=>t,t=>Promise.reject(t)),s.interceptors.response.use(t=>t,t=>Promise.reject(t));let o={signup:async t=>(await s.post("/auth/signup",t,{headers:{"Content-Type":"multipart/form-data"}})).data,login:async t=>(await s.post("/auth/login",t)).data,oauthLogin:async t=>(await s.post("/auth/oauth/login",t)).data,resetPassword:async t=>(await s.post("/auth/reset-password",t)).data,logout:async()=>(await s.post("/auth/logout")).data,getMe:async()=>(await s.get("/auth/me")).data},r={getAllUsers:async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return(await s.get("/users?page=".concat(t,"&limit=").concat(e))).data},getUserById:async t=>(await s.get("/users/".concat(t))).data,updateProfile:async t=>(await s.put("/users/profile",t,{headers:{"Content-Type":"multipart/form-data"}})).data,deleteUser:async t=>(await s.delete("/users/".concat(t))).data}},6602:function(t,e,a){"use strict";a.d(e,{t:function(){return r}});var s=a(9625),o=a(1837);let r=(0,s.Ue)((t,e)=>({user:null,isLoading:!0,isAuthenticated:!1,login:async(e,a)=>{t({isLoading:!0});try{let s=await o.iJ.login({email:e,password:a});s.user&&(t({user:s.user,isAuthenticated:!0}),localStorage.setItem("auth",JSON.stringify({user:s.user,isAuthenticated:!0})))}catch(t){throw t}finally{t({isLoading:!1})}},oauthLogin:async(e,a,s)=>{t({isLoading:!0});try{console.log("Auth store: Starting OAuth login for provider:",e),console.log("Auth store: Access token length:",null==a?void 0:a.length),console.log("Auth store: User data:",s);let r=await o.iJ.oauthLogin({provider:e,accessToken:a,userData:s});return(console.log("Auth store: API response:",r),r.user)?(console.log("Auth store: Setting user and authentication state"),console.log("Auth store: User data to set:",r.user),t({user:r.user,isAuthenticated:!0}),localStorage.setItem("auth",JSON.stringify({user:r.user,isAuthenticated:!0})),console.log("Auth store: Saved to localStorage")):console.log("Auth store: No user in response"),r}catch(t){throw console.error("Auth store: OAuth login error:",t),t}finally{t({isLoading:!1})}},signup:async e=>{t({isLoading:!0});try{let a=await o.iJ.signup(e);a.user&&(t({user:a.user,isAuthenticated:!0}),localStorage.setItem("auth",JSON.stringify({user:a.user,isAuthenticated:!0})))}catch(t){throw t}finally{t({isLoading:!1})}},logout:async()=>{t({isLoading:!0});try{await o.iJ.logout(),t({user:null,isAuthenticated:!1}),localStorage.removeItem("auth")}catch(e){console.error("Logout error:",e),t({user:null,isAuthenticated:!1}),localStorage.removeItem("auth")}finally{t({isLoading:!1})}},getMe:async()=>{t({isLoading:!0});try{let e=await o.iJ.getMe();e.user?(t({user:e.user,isAuthenticated:!0}),localStorage.setItem("auth",JSON.stringify({user:e.user,isAuthenticated:!0}))):(t({user:null,isAuthenticated:!1}),localStorage.removeItem("auth"))}catch(a){var e;(null===(e=a.response)||void 0===e?void 0:e.status)===401||console.error("Auth check error:",a),t({user:null,isAuthenticated:!1}),localStorage.removeItem("auth")}finally{t({isLoading:!1})}},setUser:e=>{t({user:e,isAuthenticated:!!e}),e?localStorage.setItem("auth",JSON.stringify({user:e,isAuthenticated:!0})):localStorage.removeItem("auth")},reset:()=>{t({user:null,isAuthenticated:!1,isLoading:!1}),localStorage.removeItem("auth")},initialize:()=>{try{let e=localStorage.getItem("auth");if(e){let{user:a,isAuthenticated:s}=JSON.parse(e);t({user:a,isAuthenticated:s,isLoading:!1})}else t({isLoading:!1})}catch(e){console.error("Error loading auth state:",e),localStorage.removeItem("auth"),t({isLoading:!1})}}}))}},function(t){t.O(0,[42,971,117,744],function(){return t(t.s=6382)}),_N_E=t.O()}]);